#include <stdlib.h>
#include <stdio.h>

#include <unistd.h>
#include <fcntl.h>
#include <string.h>

#include <sys/wait.h>
#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>

#define SIZE_BUF 256

int main(int argc, char const *argv[]) {
  const char *name_pipe = "tube-test";

  char msg_read[SIZE_BUF];
  int fd = -1;

  if( ( fd = open(name_pipe, O_RDONLY) )  ==  -1 ) {
    perror("Error with 'open()' in read_pipe.c");
    return errno;
  }

  size_t size_r;
  if( ( size_r = read(fd, msg_read, SIZE_BUF) )  ==  -1 ) {
    perror("Error with 'read()' in read_pipe.c");
    return errno;
  }
  msg_read[size_r] = '\0';

  printf("Msg received: %s\n", msg_read);

  unlink("tube-test");

  return 0;
}
