#include "manip_file.h"
void test_count_file(const char* path) {
  printf("There is %d file(s) in this directory.\n", count_file(path, M_NOPRINT));
}

void test_count_dir(const char* path) {
  system("mkdir dir1 dir2 dir3");
  int num_dir = count_dir(path);
  printf("There is %d directory(ies) in this directory.\n", num_dir);
  system("rmdir dir1 dir2 dir3");
  if(num_dir == 3)
    printf("'count_dir()': success.\n");
  else
    printf("'count_dir()': fail.\n");
}

void test_count_link(const char* path) {
  symlink("/home/user/", "home");
  symlink("/home/user/Téléchargements/", "download");
  int num_link = count_link(path);
  printf("There is %d link(s) in this directory.\n", num_link);
  system("rm home download");
  if(num_link == 2)
    printf("'count_link()': success.\n");
  else
    printf("'count_link()': fail.\n");
}

int main(int argc, char const *argv[])
{
  if(argc < 2) {
    fprintf(stderr, "Error: 'count()' need one argument (path argument).\n");
    return NEED_ARG;
  }

  if(!strcmp(argv[1], "here")) { // if argument is "here" excute program with pwd
    char pwd[1024];
    getcwd(pwd, 1024);

    printf("You are here: '%s'\n\n", pwd);
    test_count_file(pwd);
    printf("\n");
    test_count_dir(pwd);
    printf("\n");
    test_count_link(pwd);
    return 0;
  }

  printf("There is %d file(s).\n", count_file(argv[1], M_PRINT));
  return 0;
}
